@import "tailwindcss";

@custom-variant dark (&:where(.dark, .dark *));

/* ==========================================================================
   Theme & base
   ========================================================================== */

/* --- Tailwind theme: light (default) + dark variant colors --- */
@theme inline {
  /* Accent; dark shade derived for hover/active (only --color-accent is overridden at runtime) */
  --color-accent: #d946ef;
  --color-accent-dark: color-mix(in srgb, var(--color-accent) 78%, black);

  /* Surface */
  --color-surface: #f5f5f7;
  --color-surface-light: #e5e5ea;
  --color-surface-card: #fff;
  --color-surface-hover: #ededf0;
  --color-surface-dark: #1a1a2e;
  --color-surface-light-dark: #224;
  --color-surface-card-dark: #16213e;
  --color-surface-hover-dark: #1a2744;

  /* Border / divider */
  --color-edge: rgb(0 0 0 / 8%);
  --color-edge-dark: rgb(255 255 255 / 5%);

  /* Text */
  --color-fg: #1a1a2e;
  --color-fg-dark: #e0e0e0;
  --color-muted: #6b6b80;
  --color-muted-dark: #a0a0b0;

  /* Semantic */
  --color-success: #16a34a;
  --color-success-dark: #4ade80;
  --color-danger: #dc2626;
  --color-danger-dark: #f87171;
  --color-warning: #ca8a04;
  --color-warning-dark: #fbbf24;
}

/* Smooth transitions when switching themes */
html {
  @apply transition-colors duration-200 ease-[ease];
}

/* ==========================================================================
   Layout
   ========================================================================== */

/* Sticky app header bar */
.header-bar {
  @apply border-b border-edge dark:border-edge-dark
    bg-surface-card/80 dark:bg-surface-card-dark/80 backdrop-blur-sm sticky top-0 z-10;
}

/* ==========================================================================
   Typography & links
   ========================================================================== */

/* Links */
a {
  @apply text-fg dark:text-fg-dark underline decoration-dotted underline-offset-2
    transition-[text-decoration-style] duration-150 ease-[ease];
}

a:hover {
  text-decoration-style: solid;
}

/* Inline text that looks like a link (dotted underline, hover solid) */
.link-text {
  @apply text-xs underline decoration-dotted underline-offset-2 hover:decoration-solid;
}

/* Semantic text utilities (standalone dark-mode pairs) */
.text-body {
  @apply text-fg dark:text-fg-dark;
}

.text-muted-standalone {
  @apply text-muted dark:text-muted-dark;
}

/* ==========================================================================
   Cards
   ========================================================================== */

/* Card container */
.card {
  @apply rounded-md px-5 py-4 border
    bg-surface-card dark:bg-surface-card-dark
    border-edge dark:border-edge-dark;
}

/* Card header: full-bleed bar above card content (use inside .card) */
.card-header-wrapper {
  @apply -mx-5 -mt-5 mb-4 min-w-0;
}

.card-header {
  @apply w-full text-left bg-surface-light dark:bg-surface-light-dark px-5 py-3 rounded-t-xl flex items-center justify-between gap-2;
}

/* Collapsed chart card: no extra space below header */
.card--collapsed {
  @apply pb-0;
}

.card--collapsed .card-header-wrapper {
  @apply mb-0;
}

.card-header-title {
  @apply text-lg font-semibold text-fg dark:text-fg-dark m-0;
}

/* Gauge cards: less padding, no clip, so the ring isn't cut off at the sides */
.gauge-card {
  @apply rounded-md px-4 py-3 border overflow-visible
    bg-surface-card dark:bg-surface-card-dark
    border-edge dark:border-edge-dark;
}

/* Card section heading */
.card-title {
  @apply text-sm font-semibold uppercase tracking-wide mb-4
    text-muted dark:text-muted-dark;
}

/* ==========================================================================
   Buttons
   ========================================================================== */

.btn-primary {
  @apply rounded-lg px-5 py-2.5 text-sm font-medium transition-colors cursor-pointer
    disabled:opacity-50 disabled:cursor-not-allowed
    bg-accent text-white hover:bg-accent-dark;
}

.btn-ghost {
  @apply rounded-lg px-5 py-2.5 text-sm font-medium transition-colors cursor-pointer
    disabled:opacity-50 disabled:cursor-not-allowed
    border border-edge dark:border-edge-dark
    bg-transparent text-fg dark:text-fg-dark
    hover:bg-surface-hover dark:hover:bg-surface-hover-dark;
}

.btn-ghost-accent {
  @apply rounded-lg px-5 py-2.5 text-sm font-medium transition-colors cursor-pointer
    disabled:opacity-50 disabled:cursor-not-allowed
    border border-accent bg-accent/10 text-black dark:text-white
    hover:bg-accent/20;
}

.btn-ghost-sm {
  @apply rounded-lg border border-current/30 bg-transparent px-3 py-1.5 text-sm font-medium
    opacity-90 hover:opacity-100 hover:bg-current/10 transition-colors cursor-pointer;
}

/* Nav tab button */
.btn-tab {
  @apply cursor-pointer px-3 py-1.5 rounded-md text-sm font-medium transition-colors;
}

.btn-tab-active {
  @apply bg-surface-hover dark:bg-surface-hover-dark text-fg dark:text-fg-dark;
}

.btn-tab-inactive {
  @apply text-muted dark:text-muted-dark hover:text-fg dark:hover:text-fg-dark hover:bg-surface-hover dark:hover:bg-surface-hover-dark;
}

/* Chart legend toggle button */
.legend-btn {
  @apply flex items-center gap-1.5 text-xs cursor-pointer select-none transition-opacity;
}

/* ==========================================================================
   Form: inputs & labels
   ========================================================================== */

/* Text inputs and selects */
.input {
  @apply w-full rounded-md border px-3 py-2 text-sm
    border-edge dark:border-edge-dark
    bg-surface-light dark:bg-surface-light-dark
    text-fg dark:text-fg-dark
    focus:outline-none focus:ring-2 focus:ring-accent;
}

/* Input error state (combine with .input) */
.input-danger {
  @apply border-danger dark:border-danger-dark;
}

/* Hide number input spinner (Chrome, Safari, Edge) */
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

/* Hide number input spinner (Firefox) */
input[type="number"] {
  -moz-appearance: textfield;
  appearance: textfield;
}

/* Range input */
.input-range {
  @apply w-full h-2 rounded-md appearance-none bg-surface-light dark:bg-surface-light-dark accent-accent;
}

/* Form / field label */
.label {
  @apply text-xs font-medium uppercase tracking-wide
    text-muted dark:text-muted-dark;
}

/* Small label above a stat value */
.stat-label {
  @apply text-xs uppercase tracking-wide
    text-muted dark:text-muted-dark;
}

/* Field label hint (trigger + tooltip on hover) */
.field-hint-trigger {
  @apply relative inline-flex shrink-0 rounded-full
    text-muted dark:text-muted-dark
    hover:text-fg dark:hover:text-fg-dark
    focus:outline-none focus:ring-2 focus:ring-accent focus:ring-offset-1 focus:ring-offset-surface dark:focus:ring-offset-surface-dark;
}

.field-hint-tooltip {
  @apply absolute left-1/2 -translate-x-1/2 bottom-full mb-1.5 z-20
    px-3 py-2 min-w-60 max-w-sm rounded-md text-sm text-muted dark:text-muted-dark
    bg-surface-card dark:bg-surface-card-dark border border-edge dark:border-edge-dark
    shadow-lg pointer-events-none
    opacity-0 invisible transition-opacity duration-150;
}

.field-hint-trigger:hover .field-hint-tooltip {
  @apply opacity-100 visible;
}

/* ==========================================================================
   Form: switch
   ========================================================================== */

/* Toggle switch (track + thumb) */
.switch {
  @apply relative inline-flex items-center h-6 w-11 shrink-0 rounded-full border transition-colors
    focus:outline-none focus:ring-2 focus:ring-accent focus:ring-offset-2 focus:ring-offset-surface dark:focus:ring-offset-surface-dark;
}

.switch-on {
  @apply bg-accent border-accent;
}

.switch-off {
  @apply bg-surface-light dark:bg-surface-light-dark border-edge dark:border-edge-dark;
}

.switch-thumb {
  @apply pointer-events-none inline-block h-5 w-5 rounded-full bg-white shadow ring-0 transition translate-x-0.5;
}

.switch-thumb-on {
  @apply translate-x-5;
}

.switch-thumb-off {
  @apply translate-x-0.5;
}

/* ==========================================================================
   Form: option list (exclusive radio list)
   ========================================================================== */

.option-list {
  @apply flex flex-col rounded-md border border-edge dark:border-edge-dark overflow-hidden
    bg-surface-light dark:bg-surface-light-dark max-h-72 overflow-y-auto;
}

.option-row {
  @apply flex items-center gap-3 px-4 py-2.5 cursor-pointer border-b border-edge/50 dark:border-edge-dark/50
    last:border-b-0 transition-colors
    hover:bg-surface-hover dark:hover:bg-surface-hover-dark;
}

.option-row-selected {
  @apply bg-accent/15 dark:bg-accent/20 border-l-2 border-l-accent -ml-px pl-[calc(1rem-1px)];
}

.option-radio-input {
  @apply sr-only;
}

.option-radio-dot {
  @apply shrink-0 w-4 h-4 rounded-full border-2 border-edge dark:border-edge-dark
    transition-colors duration-150;
}

.option-row:has(.option-radio-input:checked) .option-radio-dot,
.option-row-selected .option-radio-dot {
  @apply border-accent bg-accent ring-4 ring-accent/25;
}

.option-label {
  @apply text-sm text-fg dark:text-fg-dark font-medium;
}

.option-tag {
  @apply ml-1.5 text-xs text-muted dark:text-muted-dark font-normal;
}

/* ==========================================================================
   Form: checkbox
   ========================================================================== */

/* Custom checkbox (accent color, like option-radio) */
.checkbox-input {
  @apply sr-only;
}

.checkbox-box {
  @apply shrink-0 w-4 h-4 rounded border-2 border-edge dark:border-edge-dark
    flex items-center justify-center transition-colors duration-150
    focus-within:ring-2 focus-within:ring-accent focus-within:ring-offset-2 focus-within:ring-offset-surface dark:focus-within:ring-offset-surface-dark;
}

.checkbox-check {
  @apply w-3 h-3 opacity-0 transition-opacity duration-150 pointer-events-none;
}

.checkbox-input:checked ~ .checkbox-box {
  @apply border-accent bg-accent ring-4 ring-accent/25;
}

.checkbox-input:checked ~ .checkbox-box .checkbox-check {
  @apply opacity-100;
}

/* ==========================================================================
   Surface & border utilities
   ========================================================================== */
/* Use these in components instead of repeating theme pairs:
   border-default, bg-surface-subtle, text-body, text-muted-standalone.
   Layout combos (flex items-center justify-center, grid...) are kept inline
   in JSX unless the exact same string appears 5+ timesâ€”then add a utility here. */

.border-default {
  @apply border-edge dark:border-edge-dark;
}

.bg-surface-subtle {
  @apply bg-surface-light dark:bg-surface-light-dark;
}

/* ==========================================================================
   Callouts & tooltips
   ========================================================================== */

/* Pending / highlight callout (e.g. pending changes) */
.highlight-box {
  @apply rounded-md px-5 py-4 border border-accent/50 bg-accent/10;
}

/* Chart tooltip container (card-style, compact) */
.tooltip-card {
  @apply rounded-md px-3 py-2 text-sm shadow-xl
    bg-surface-card dark:bg-surface-card-dark
    border border-edge dark:border-edge-dark;
}

/* ==========================================================================
   Notifications & toasts
   ========================================================================== */

.notification-success {
  @apply relative overflow-hidden rounded-md border-l-4 border-l-success dark:border-l-success-dark
    bg-success/10 dark:bg-success-dark/10 border border-success/20 dark:border-success-dark/20
    text-success dark:text-success-dark shadow-sm;
}

.notification-warning {
  @apply relative overflow-hidden rounded-md border-l-4 border-l-danger dark:border-l-danger-dark
    bg-danger/10 dark:bg-danger-dark/10 border border-danger/20 dark:border-danger-dark/20
    text-danger dark:text-danger-dark shadow-sm;
}

/* Toast / inline message (success or warning) */
.toast-success {
  @apply text-sm text-success dark:text-success-dark;
}

.toast-warning {
  @apply text-sm text-danger dark:text-danger-dark;
}

/* ==========================================================================
   Badges & status indicators
   ========================================================================== */

/* Status pills / badges */
.badge-success {
  @apply text-[10px] bg-success/20 dark:bg-success-dark/20 text-success dark:text-success-dark px-1.5 py-0.5 rounded font-medium;
}

.badge-warning {
  @apply text-[10px] bg-warning/20 dark:bg-warning-dark/20 text-warning dark:text-warning-dark px-1.5 py-0.5 rounded font-medium;
}

/* Status dots (connection indicator) */
.status-dot {
  @apply inline-block w-2 h-2 rounded-full;
}

.status-dot-danger {
  @apply bg-danger dark:bg-danger-dark;
}

.status-dot-success {
  @apply bg-success dark:bg-success-dark animate-pulse;
}

/* ==========================================================================
   Drop zone
   ========================================================================== */

/* Drop zone indicator (border color overridden by ConfigContext with user accent) */
.drop-zone-indicator {
  border-width: 3px;
  border-style: dashed;
  border-color: color-mix(in oklch, var(--color-accent) 60%, transparent);
}

/* ==========================================================================
   Documentation page
   ========================================================================== */

.doc-body {
  @apply text-fg dark:text-fg-dark text-sm leading-relaxed;
}

.code-inline {
  @apply px-1.5 py-0.5 rounded bg-surface-light dark:bg-surface-light-dark text-xs;
}

.doc-page {
  @apply px-10 py-6;
}

.doc-page .doc-body {
  @apply text-base leading-relaxed;
}

.doc-page .code-inline {
  @apply text-sm;
}

.doc-page table th,
.doc-page table td {
  @apply p-3;
}

.doc-page table {
  @apply text-base;
}

/* Theme-aware table: border and row styles (use .doc-table or .doc-pools-table on table) */
.doc-table,
.doc-pools-table {
  @apply w-full text-fg dark:text-fg-dark text-sm leading-relaxed border border-edge dark:border-edge-dark text-left;
}

.doc-table thead tr,
.doc-pools-table thead tr {
  @apply border-b border-edge dark:border-edge-dark bg-surface-light dark:bg-surface-light-dark;
}

.doc-table tbody tr,
.doc-pools-table tbody tr {
  @apply border-b border-edge dark:border-edge-dark;
}

/* Smaller font for solo pools table (overrides .doc-page table above) */
.doc-page table.doc-pools-table {
  @apply text-xs;
}

.doc-page table.doc-pools-table th,
.doc-page table.doc-pools-table td {
  @apply p-2 whitespace-nowrap;
}

.doc-page table.doc-pools-table .code-inline {
  @apply text-xs;
}

/* API / code block (pre) */
.api-pre {
  @apply text-xs text-fg dark:text-fg-dark overflow-auto max-h-96 p-4 rounded-md
    bg-surface-light dark:bg-surface-light-dark border border-edge dark:border-edge-dark
    whitespace-pre-wrap break-all;
}
