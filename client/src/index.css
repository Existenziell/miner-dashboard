@import "tailwindcss";

@custom-variant dark (&:where(.dark, .dark *));

/* ==========================================================================
   Use @theme so high-contrast and theme previews can override variables.
   ========================================================================== */

@theme {
  /* --- Accent (--color-accent overridden at runtime) --- */
  --color-accent: #d946ef;
  --color-accent-dark: color-mix(in srgb, var(--color-accent) 78%, black);

  /* --- Surface --- */
  --color-surface: var(--color-gray-50);
  --color-surface-light: var(--color-gray-100);
  --color-surface-card: var(--color-white);
  --color-surface-hover: var(--color-gray-200);
  --color-surface-dark: var(--color-gray-800);
  --color-surface-light-dark: var(--color-gray-800);
  --color-surface-card-dark: var(--color-gray-900);
  --color-surface-hover-dark: var(--color-gray-700);

  /* --- Border / edge --- */
  --color-edge: var(--color-gray-200);
  --color-edge-dark: var(--color-gray-700);

  /* --- Text --- */
  --color-fg: var(--color-gray-700);
  --color-fg-dark: var(--color-gray-300);
  --color-muted: var(--color-gray-600);
  --color-muted-dark: var(--color-gray-500);

  /* --- Chart (Recharts; read in JS) --- */
  --chart-grid-light: #d1d5db;
  --chart-axis-light: #9ca3af;
  --chart-grid-dark: #336;
  --chart-axis-dark: #668;

  /* --- Typography scale: 2xs (10px) | xs (12px) | sm (14px) | base (16px) | lg | xl | 2xl --- */
  --font-size-2xs: 0.625rem;
  --text-2xs: var(--font-size-2xs);

  /* --- Semantic (status, alerts) --- */
  --color-success: #16a34a;
  --color-success-dark: #4ade80;
  --color-danger: #dc2626;
  --color-danger-dark: #f87171;
  --color-warning: #ca8a04;
  --color-warning-dark: #fbbf24;

  /* --- UI: on-accent, switch thumb, drop zone --- */
  --color-on-accent: #000;
  --color-on-accent-dark: #fff;
  --color-switch-thumb: var(--color-white);
  --color-switch-thumb-dark: var(--color-white);
  --color-drop-zone-edge: color-mix(in oklch, var(--color-accent) 60%, transparent);

  /* --- Terminal (ApiPage cURL block; always dark bg) --- */
  --color-terminal-bg: #1e1e1e;
  --color-terminal-bar: #2d2d2d;
  --color-terminal-border: #3d3d3d;
  --color-terminal-dot-close: #ff5f56;
  --color-terminal-dot-minimize: #ffbd2e;
  --color-terminal-dot-open: #27c93f;
  --color-terminal-label: var(--color-gray-400);
  --color-terminal-text: var(--color-gray-300);
  --color-terminal-prompt: var(--color-green-400);
}

/* ==========================================================================
   Theme: high contrast
   ========================================================================== */

/* High contrast: max text contrast, strong borders (applied on html) */
html.high-contrast {
  --color-fg: #000;
  --color-muted: var(--color-gray-800);
  --color-edge: var(--color-gray-400);
  --color-surface: var(--color-gray-200);
  --color-surface-light: var(--color-gray-300);
  --color-surface-card: var(--color-white);
  --color-surface-hover: var(--color-gray-400);
}

html.dark.high-contrast,
html.high-contrast.dark {
  --color-fg-dark: #fff;
  --color-muted-dark: var(--color-gray-300);
  --color-edge-dark: var(--color-gray-500);
  --color-surface-dark: var(--color-gray-950);
  --color-surface-light-dark: var(--color-gray-900);
  --color-surface-card-dark: var(--color-gray-900);
  --color-surface-hover-dark: var(--color-gray-800);
}

/* Theme preview card: visible hover border in HC */
html.high-contrast .theme-preview-card:hover:not([aria-pressed="true"]) {
  border-color: var(--color-fg) !important;
}

html.dark.high-contrast .theme-preview-card:hover:not([aria-pressed="true"]),
html.high-contrast.dark .theme-preview-card:hover:not([aria-pressed="true"]) {
  border-color: var(--color-fg-dark) !important;
}

/* Theme previews (Appearance tab): scoped overrides for preview box */
.theme-preview-light {
  --color-surface: var(--color-gray-50);
  --color-surface-light: var(--color-gray-100);
  --color-surface-card: var(--color-white);
  --color-surface-hover: var(--color-gray-200);
  --color-edge: var(--color-gray-200);
  --color-fg: var(--color-gray-700);
  --color-fg-dark: var(--color-gray-700);
  --color-muted: var(--color-gray-600);
  --color-muted-dark: var(--color-gray-600);
}

.theme-preview-dark {
  --color-surface: var(--color-gray-950);
  --color-surface-light: var(--color-gray-900);
  --color-surface-card: var(--color-gray-900);
  --color-surface-hover: var(--color-gray-800);
  --color-edge: var(--color-gray-700);
  --color-fg: var(--color-gray-300);
  --color-fg-dark: var(--color-gray-300);
  --color-muted: var(--color-gray-500);
  --color-muted-dark: var(--color-gray-500);
}

.theme-preview-light-hc {
  --color-surface: var(--color-gray-200);
  --color-surface-light: var(--color-gray-300);
  --color-surface-card: var(--color-white);
  --color-surface-hover: var(--color-gray-400);
  --color-edge: var(--color-gray-400);
  --color-fg: #000;
  --color-fg-dark: #000;
  --color-muted: var(--color-gray-800);
  --color-muted-dark: var(--color-gray-800);
}

.theme-preview-dark-hc {
  --color-surface: var(--color-gray-950);
  --color-surface-light: var(--color-gray-900);
  --color-surface-card: var(--color-gray-900);
  --color-surface-hover: var(--color-gray-800);
  --color-edge: var(--color-gray-500);
  --color-fg: #fff;
  --color-fg-dark: #fff;
  --color-muted: var(--color-gray-300);
  --color-muted-dark: var(--color-gray-300);
}

/* ==========================================================================
   Utilities
   ========================================================================== */

.text-normal {
  @apply text-fg dark:text-fg-dark;
}

.text-muted {
  @apply text-muted dark:text-muted-dark;
}

a {
  @apply text-fg dark:text-fg-dark underline decoration-dotted underline-offset-2 transition-[text-decoration-style] duration-150 ease-[ease];
}

a:hover {
  color: var(--color-accent);
  text-decoration-style: solid;
}

.text-link {
  @apply underline decoration-dotted underline-offset-2 hover:decoration-solid hover:text-accent cursor-pointer;
}

.header-bar {
  @apply border-b border-edge dark:border-edge-dark bg-surface-card/80 dark:bg-surface-card-dark/80 backdrop-blur-sm sticky top-0 z-10;
}

.border-default {
  @apply border-edge dark:border-edge-dark;
}

.bg-surface-subtle {
  @apply bg-surface-light dark:bg-surface-light-dark;
}

.drop-zone-indicator {
  border-width: 3px;
  border-style: dashed;
  border-color: var(--color-drop-zone-edge);
}

html {
  @apply antialiased transition-colors duration-200 ease-[ease];
}

html.high-contrast a {
  text-decoration-style: solid;
}

.api-pre {
  @apply text-xs text-fg dark:text-fg-dark overflow-auto max-h-96 p-4 rounded-md bg-surface-light dark:bg-surface-light-dark border border-edge dark:border-edge-dark whitespace-pre-wrap break-all;
}

/* ==========================================================================
   Cards
   ========================================================================== */

.card {
  @apply rounded-md px-5 py-4 border bg-surface-card dark:bg-surface-card-dark border-edge dark:border-edge-dark;
}

.card-header-wrapper {
  @apply -mx-5 -mt-4 mb-4 min-w-0 rounded-t-md;
}

.card-header {
  @apply w-full text-left bg-surface-light dark:bg-surface-light-dark px-5 py-3 rounded-t-md flex items-center justify-between gap-2;
}

.card-header-title {
  @apply text-lg font-semibold text-fg dark:text-fg-dark m-0;
}

.card-title {
  @apply text-sm font-semibold uppercase tracking-wide mb-4 text-muted dark:text-muted-dark;
}

.card-subtitle {
  @apply text-muted dark:text-muted-dark text-sm mb-6 max-w-prose;
}

.card--collapsed {
  @apply pb-0;
}

.card--collapsed .card-header-wrapper {
  @apply mb-0;
}

.gauge-card {
  @apply rounded-md px-4 py-3 border overflow-visible bg-surface-card dark:bg-surface-card-dark border-edge dark:border-edge-dark;
}

/* ==========================================================================
   Buttons
   ========================================================================== */

.btn-primary {
  @apply rounded-lg px-5 py-2.5 text-sm font-medium transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed bg-accent text-on-accent dark:text-on-accent-dark hover:bg-accent-dark;
}

.btn-ghost {
  @apply rounded-lg px-5 py-2.5 text-sm font-medium transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed border border-edge dark:border-edge-dark bg-transparent text-fg dark:text-fg-dark hover:bg-surface-hover dark:hover:bg-surface-hover-dark;
}

.btn-ghost-accent {
  @apply rounded-lg px-5 py-2.5 text-sm font-medium transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed border border-accent bg-accent/10 text-on-accent dark:text-on-accent-dark hover:bg-accent/20;
}

.btn-ghost-sm {
  @apply rounded-lg border border-current/30 bg-transparent px-3 py-1.5 text-sm font-medium opacity-90 hover:opacity-100 hover:bg-current/10 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:opacity-50 disabled:hover:bg-transparent;
}

.swap-pool-btn:hover {
  @apply text-accent hover:scale-110 transition-colors cursor-pointer;
}

.btn-tab {
  @apply cursor-pointer px-3 py-1.5 rounded-md text-sm font-medium transition-colors;
}

.btn-tab-active {
  @apply bg-surface-hover dark:bg-surface-hover-dark text-fg dark:text-fg-dark;
}

.btn-tab-inactive {
  @apply text-muted dark:text-muted-dark hover:text-fg dark:hover:text-fg-dark hover:bg-surface-hover dark:hover:bg-surface-hover-dark;
}

.theme-toggle-btn {
  @apply flex items-center gap-1.5 px-2.5 py-1.5 rounded-md text-xs font-medium transition-colors cursor-pointer bg-surface-light dark:bg-surface-light-dark text-muted dark:text-muted-dark hover:bg-surface-hover dark:hover:bg-surface-hover-dark hover:text-fg dark:hover:text-fg-dark;
}

.legend-btn {
  @apply flex items-center gap-1.5 text-xs cursor-pointer select-none transition-opacity;
}

/* ==========================================================================
   Form
   ========================================================================== */

.input {
  @apply w-full rounded-md border px-3 py-2 text-sm border-edge dark:border-edge-dark bg-surface-light dark:bg-surface-light-dark text-fg dark:text-fg-dark focus:outline-none focus:ring-2 focus:ring-accent;
}

.input::placeholder {
  color: var(--color-muted);
}

.dark .input::placeholder {
  color: var(--color-muted-dark);
}

.input-danger {
  @apply border-danger dark:border-danger-dark;
}

input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

input[type="number"] {
  -moz-appearance: textfield;
  appearance: textfield;
}

.input-range {
  @apply w-full h-2 rounded-md appearance-none bg-surface-light dark:bg-surface-light-dark accent-accent;
}

.label {
  @apply text-xs font-medium uppercase tracking-wide text-muted dark:text-muted-dark;
}

.stat-label {
  @apply text-xs uppercase tracking-wide text-muted dark:text-muted-dark;
}

.stat-value {
  @apply truncate min-w-0 text-base font-medium;
}

.hint-trigger {
  @apply relative inline-flex shrink-0 rounded-full text-muted dark:text-muted-dark focus:outline-none focus:ring-2 focus:ring-accent focus:ring-offset-1 focus:ring-offset-surface dark:focus:ring-offset-surface-dark;
}

.hint-trigger:hover {
  color: var(--color-accent);
}

.hint-tooltip {
  @apply absolute left-1/2 -translate-x-1/2 bottom-full mb-1.5 z-20 px-3 py-2 min-w-60 max-w-sm rounded-md text-sm text-muted dark:text-muted-dark bg-surface-card dark:bg-surface-card-dark border border-edge dark:border-edge-dark shadow-lg pointer-events-none opacity-0 invisible transition-opacity duration-150;
}

.hint-trigger:hover .hint-tooltip {
  @apply opacity-100 visible;
}

/* ==========================================================================
  Switch
  ========================================================================== */

.switch {
  @apply relative inline-flex items-center h-6 w-11 shrink-0 rounded-full border transition-colors focus:outline-none focus:ring-2 focus:ring-accent focus:ring-offset-2 focus:ring-offset-surface dark:focus:ring-offset-surface-dark;
}

.switch-on {
  @apply bg-accent border-accent;
}

.switch-off {
  @apply bg-surface-light dark:bg-surface-light-dark border-edge dark:border-edge-dark;
}

.switch-thumb {
  @apply pointer-events-none inline-block h-5 w-5 rounded-full shadow ring-0 transition translate-x-0.5 bg-switch-thumb dark:bg-switch-thumb-dark;
}

.switch-thumb-on {
  @apply translate-x-5;
}

.switch-thumb-off {
  @apply translate-x-0.5;
}

/* ==========================================================================
  Option list (exclusive radio)
  ========================================================================== */

.option-list {
  @apply flex flex-col rounded-md border border-edge dark:border-edge-dark overflow-hidden bg-surface-light dark:bg-surface-light-dark max-h-72 overflow-y-auto;
}

.option-row {
  @apply flex items-center gap-3 px-4 py-2.5 cursor-pointer border-b border-edge/50 dark:border-edge-dark/50 last:border-b-0 transition-colors hover:bg-surface-hover dark:hover:bg-surface-hover-dark;
}

.option-row-selected {
  @apply bg-accent/15 dark:bg-accent/20 border-l-2 border-l-accent -ml-px pl-[calc(1rem-1px)];
}

.option-radio-input {
  @apply sr-only;
}

.option-radio-dot {
  @apply shrink-0 w-4 h-4 rounded-full border-2 border-edge dark:border-edge-dark transition-colors duration-150;
}

.option-row:has(.option-radio-input:checked) .option-radio-dot,
.option-row-selected .option-radio-dot {
  @apply border-accent bg-accent ring-4 ring-accent/25;
}

.option-label {
  @apply text-sm text-fg dark:text-fg-dark font-medium;
}

.option-tag {
  @apply ml-1.5 text-xs text-muted dark:text-muted-dark font-normal;
}

/* ==========================================================================
  Checkbox
  ========================================================================== */

.checkbox-input {
  @apply sr-only;
}

.checkbox-box {
  @apply shrink-0 w-4 h-4 rounded border-2 border-edge dark:border-edge-dark flex items-center justify-center transition-colors duration-150 focus-within:ring-2 focus-within:ring-accent focus-within:ring-offset-2 focus-within:ring-offset-surface dark:focus-within:ring-offset-surface-dark;
}

.checkbox-check {
  @apply w-3 h-3 opacity-0 transition-opacity duration-150 pointer-events-none;
}

.checkbox-input:checked~.checkbox-box {
  @apply border-accent bg-accent ring-4 ring-accent/25;
}

.checkbox-input:checked~.checkbox-box .checkbox-check {
  @apply opacity-100;
}

/* ==========================================================================
   Notifications & status indicators
   ========================================================================== */

.notification-success {
  @apply relative overflow-hidden rounded-md border-l-4 border-l-success dark:border-l-success-dark bg-success/10 dark:bg-success-dark/10 border border-success/20 dark:border-success-dark/20 text-success dark:text-success-dark shadow-sm;
}

.notification-warning {
  @apply relative overflow-hidden rounded-md border-l-4 border-l-danger dark:border-l-danger-dark bg-danger/10 dark:bg-danger-dark/10 border border-danger/20 dark:border-danger-dark/20 text-danger dark:text-danger-dark shadow-sm;
}

.pending-changes {
  @apply rounded-md px-5 py-4 border border-accent/50 bg-accent/10;
}

.tooltip-card {
  @apply rounded-md px-3 py-2 text-sm shadow-xl bg-surface-card dark:bg-surface-card-dark border border-edge dark:border-edge-dark;
}

.message-success {
  @apply text-sm text-success dark:text-success-dark;
}

.message-warning {
  @apply text-sm text-danger dark:text-danger-dark;
}

.status-active {
  @apply text-2xs bg-success/20 dark:bg-success-dark/20 text-success dark:text-success-dark px-1.5 py-0.5 rounded font-medium;
}

.indicator {
  @apply inline-block w-2 h-2 rounded-full;
}

.indicator-connected {
  @apply bg-success dark:bg-success-dark;
}

.indicator-disconnected {
  @apply bg-danger dark:bg-danger-dark animate-pulse;
}

/* ==========================================================================
   Documentation page
   ========================================================================== */

.doc-page {
  @apply px-6 py-8;
}

.doc-section {
  @apply mb-12;
}

.doc-section:last-child {
  @apply mb-0;
}

.doc-body {
  @apply text-fg dark:text-fg-dark text-sm leading-relaxed;
}

.code-inline {
  @apply px-1.5 py-0.5 rounded bg-surface-light dark:bg-surface-light-dark text-xs;
}

.doc-heading {
  @apply text-2xl font-semibold text-fg dark:text-fg-dark mb-4 mt-0;
}

.doc-subheading {
  @apply text-xl font-medium text-fg dark:text-fg-dark mb-3 mt-8;
}

.doc-section>.doc-subheading:first-of-type {
  @apply mt-4;
}

.doc-prose {
  @apply max-w-prose;
}

.doc-page .doc-body {
  @apply text-base leading-7 text-fg dark:text-fg-dark;
  margin-bottom: 1em;
}

.doc-page .doc-body:last-child {
  margin-bottom: 0;
}

.doc-lead-in {
  margin-bottom: 0.5em;
}

.doc-list {
  @apply list-disc list-outside pl-6 text-fg dark:text-fg-dark text-base leading-7 space-y-2 mb-4;
}

.doc-list:last-child {
  @apply mb-0;
}

.doc-page .code-inline {
  @apply text-sm;
}

.doc-table-wrap {
  @apply my-4;
}

.doc-th {
  @apply p-3 font-semibold text-left;
}

.doc-td {
  @apply p-3 text-left;
}

.doc-th--compact,
.doc-td--compact {
  @apply p-2;
}

.doc-td--compact {
  @apply whitespace-nowrap;
}

.doc-table,
.doc-pools-table {
  @apply w-full text-fg dark:text-fg-dark text-sm leading-relaxed border border-edge dark:border-edge-dark text-left;
}

.doc-table thead tr,
.doc-pools-table thead tr {
  @apply border-b border-edge dark:border-edge-dark bg-surface-light dark:bg-surface-light-dark;
}

.doc-table tbody tr,
.doc-pools-table tbody tr {
  @apply border-b border-edge dark:border-edge-dark;
}

.doc-page table.doc-pools-table {
  @apply text-xs;
}

.doc-page table.doc-pools-table .code-inline {
  @apply text-xs;
}